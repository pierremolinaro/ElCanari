//----------------------------------------------------------------------------------------------------------------------
//  THIS FILE IS GENERATED BY EASY BINDINGS, DO NOT MODIFY IT
//  Created by Pierre Molinaro on 14/06/2021.
//----------------------------------------------------------------------------------------------------------------------

import Cocoa

//----------------------------------------------------------------------------------------------------------------------

func instanciateDebugMenuVisibilityObjectOnDidFinishLaunchingNotification () {
  gDebugMenuVisibility = DebugMenuVisibility ()
}

//----------------------------------------------------------------------------------------------------------------------

fileprivate var gDebugMenuVisibility : DebugMenuVisibility? = nil

//----------------------------------------------------------------------------------------------------------------------

fileprivate final class DebugMenuVisibility : EBObject {

  //····················································································································
  //  Property
  //····················································································································

  private var mDebugMenuItem = NSMenuItem (title: "My Debug", action: nil, keyEquivalent: "")
  private var mShowMenuController : EBReadOnlyPropertyController? = nil

  //····················································································································
  //  Init
  //····················································································································

  override init () {
    super.init ()
    self.mDebugMenuItem.submenu = NSMenu ()
    self.mDebugMenuItem.submenu?.title = "My Debug"
    self.mShowMenuController = EBReadOnlyPropertyController (
      observedObjects: [preferences_showDebugMenu_property],
      callBack: { self.updateDebugMenuVisibility () }
    )
  }

  //····················································································································

  func updateDebugMenuVisibility () {
    if let mainMenu = NSApp.mainMenu {
      if preferences_showDebugMenu_property.propval {
        mainMenu.addItem (mDebugMenuItem)
      }else if mainMenu.index (of: mDebugMenuItem) >= 0 {
        mainMenu.removeItem (mDebugMenuItem)
      }
    }
  }

  //····················································································································

}

//----------------------------------------------------------------------------------------------------------------------


//----------------------------------------------------------------------------------------------------------------------
